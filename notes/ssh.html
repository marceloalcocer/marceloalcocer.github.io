

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SSH &mdash; marceloalcocer.github.io v0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Vim" href="vim.html" />
    <link rel="prev" title="Sphinx" href="sphinx.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> marceloalcocer.github.io
          

          
          </a>

          
            
            
              <div class="version">
                v0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../notes.html">Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="backup.html">Backup</a></li>
<li class="toctree-l2"><a class="reference internal" href="bash.html">Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="c.html">C/C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="desktop.html">Desktop environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="eclipse.html">Eclipse</a></li>
<li class="toctree-l2"><a class="reference internal" href="gentoo.html">Gentoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="git.html">Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpg.html">Cryptography</a></li>
<li class="toctree-l2"><a class="reference internal" href="graphing.html">Graphing</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardware.html">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="lab_server.html">Lab server</a></li>
<li class="toctree-l2"><a class="reference internal" href="latex.html">LaTeX</a></li>
<li class="toctree-l2"><a class="reference internal" href="lu.html">Lund University</a></li>
<li class="toctree-l2"><a class="reference internal" href="network.html">Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="packages.html">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="rest.html">ReST</a></li>
<li class="toctree-l2"><a class="reference internal" href="reveal_js.html">reveal.js</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtd.html">Read The Docs</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal.html">Signal processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="sphinx.html">Sphinx</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#port-forwarding">Port forwarding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keep-process-alive">Keep process alive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#public-key-location">Public key location</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-keys">Multiple keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#key-encryption">Key Encryption</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vim.html">Vim</a></li>
<li class="toctree-l2"><a class="reference internal" href="vscode.html">Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="web.html">Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows.html">Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ultrajs.html">ultrajs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sunfleet.html">Sunfleet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../svgfragments.html">SVGFragments</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">marceloalcocer.github.io</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../notes.html">Online margin scribbles…</a> &raquo;</li>
        
      <li>SSH</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="ssh">
<h1>SSH<a class="headerlink" href="#ssh" title="Permalink to this headline">¶</a></h1>
<section id="port-forwarding">
<h2>Port forwarding<a class="headerlink" href="#port-forwarding" title="Permalink to this headline">¶</a></h2>
<p>Can tunnel arbitrary traffic through SSH by client-side port forwarding; local TCP socket opened (alongside usual SSH connection), and any connections made to it are forwarded over SSH to the client, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ssh -L 8080:remote-host-1:8888 remote-host-0
</pre></div>
</div>
<p>forwards all TCP connections to <code class="docutils literal notranslate"><span class="pre">8080</span></code> on the SSH client to <code class="docutils literal notranslate"><span class="pre">remote-host-1:8888</span></code> via SSH connection to <code class="docutils literal notranslate"><span class="pre">remote-host-0</span></code>. As such, <code class="docutils literal notranslate"><span class="pre">remote-host-1</span></code> must be reachable from <code class="docutils literal notranslate"><span class="pre">remote-host-0</span></code>.</p>
<p>N.b. you probably also want <code class="docutils literal notranslate"><span class="pre">-T</span></code> flag to disable TTY allocation so as to avoid a prompt.</p>
<p>This will work for basic protocols (e.g. text based protocols on the transport layer), but will likely become brittle for more complex higher level protocols. For these it’s probably best to use dynamic port forwarding on the application layer; a local SOCKS <a class="footnote-reference brackets" href="#id2" id="id1">1</a> (application layer protocol) server will be run (using a local TCP socket), and connections to the local server will then be tunnelled through SSH to the remote server, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ssh -D 8080 remote-host-0
</pre></div>
</div>
<p>forwards all connections to <code class="docutils literal notranslate"><span class="pre">8080</span></code> on the SSH client to <code class="docutils literal notranslate"><span class="pre">remote-host-0</span></code> for further handling. Configuring a local browser to use <code class="docutils literal notranslate"><span class="pre">localhost:8080</span></code> as a SOCKS proxy would therefore result in all HTTP traffic being routed through <code class="docutils literal notranslate"><span class="pre">remote-host-0</span></code> via SSH, essentially conscripting <code class="docutils literal notranslate"><span class="pre">remote-host-0</span></code> to act as an HTTP proxy.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/SOCKS">https://en.wikipedia.org/wiki/SOCKS</a></p>
</dd>
</dl>
</section>
<section id="keep-process-alive">
<h2>Keep process alive<a class="headerlink" href="#keep-process-alive" title="Permalink to this headline">¶</a></h2>
<p>Can keep process alive after closing SSH session by using nohup <a class="footnote-reference brackets" href="#id4" id="id3">2</a>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ nohup python3 -m http.server 8000 &amp;
</pre></div>
</div>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p><a class="reference external" href="https://askubuntu.com/questions/8653/how-to-keep-processes-running-after-ending-ssh-session/222855#222855">https://askubuntu.com/questions/8653/how-to-keep-processes-running-after-ending-ssh-session/222855#222855</a></p>
</dd>
</dl>
</section>
<section id="public-key-location">
<h2>Public key location<a class="headerlink" href="#public-key-location" title="Permalink to this headline">¶</a></h2>
<p>For SSH with PKC authentication, public keys should be located in <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> user directory of SSH host (server) <a class="footnote-reference brackets" href="#id6" id="id5">3</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id5">3</a></span></dt>
<dd><p><a class="reference external" href="https://www.linode.com/docs/security/authentication/use-public-key-authentication-with-ssh/">https://www.linode.com/docs/security/authentication/use-public-key-authentication-with-ssh/</a></p>
</dd>
</dl>
</section>
<section id="multiple-keys">
<h2>Multiple keys<a class="headerlink" href="#multiple-keys" title="Permalink to this headline">¶</a></h2>
<p>Multiple SSH key-pairs are simply differntiated by filename, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="o">~/.</span><span class="n">ssh</span>
<span class="go">id_&lt;ID1&gt;</span>
<span class="go">id_&lt;ID1&gt;.pub</span>
<span class="go">id_&lt;ID2&gt;</span>
<span class="go">id_&lt;ID2&gt;.pub</span>
</pre></div>
</div>
<p>As such, adding new keys is just a matter of generating a new keypair with a unique filename <a class="footnote-reference brackets" href="#id8" id="id7">4</a>.</p>
<p>First, remove all key-pairs registered with SSH agent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ssh</span><span class="o">-</span><span class="n">add</span> <span class="o">-</span><span class="n">D</span>
</pre></div>
</div>
<p>Then rename original key-pair (if required):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cd</span> <span class="o">~/.</span><span class="n">ssh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mv</span> <span class="n">id_rsa</span> <span class="n">id_</span><span class="o">&lt;</span><span class="n">ID1</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mv</span> <span class="n">id_rsa</span><span class="o">.</span><span class="n">pub</span> <span class="n">id_</span><span class="o">&lt;</span><span class="n">ID1</span><span class="o">&gt;.</span><span class="n">pub</span>
</pre></div>
</div>
<p>Create new key-pair:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">b</span> <span class="mi">4096</span>          <span class="c1"># 4096 bit RSA key</span>
</pre></div>
</div>
<p>specifying a unique filename when prompted.</p>
<p>New key-pairs should automatically be registered with SSH agent.</p>
<dl class="footnote brackets">
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id7">4</a></span></dt>
<dd><p><a class="reference external" href="https://unix.stackexchange.com/questions/58969/how-to-list-keys-added-to-ssh-agent-with-ssh-add/58977">https://unix.stackexchange.com/questions/58969/how-to-list-keys-added-to-ssh-agent-with-ssh-add/58977</a></p>
</dd>
</dl>
</section>
<section id="key-encryption">
<h2>Key Encryption<a class="headerlink" href="#key-encryption" title="Permalink to this headline">¶</a></h2>
<p>SSH uses MD5 and AES for key encryption/decryption — not very safe nowadays. Can upgrade to more recent algorithm for better protection (PKCS#8) with no compatibility issue <a class="footnote-reference brackets" href="#id10" id="id9">5</a>.</p>
<p>Did so.</p>
<dl class="footnote brackets">
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id9">5</a></span></dt>
<dd><p><a class="reference external" href="https://martin.kleppmann.com/2013/05/24/improving-security-of-ssh-private-keys.html">https://martin.kleppmann.com/2013/05/24/improving-security-of-ssh-private-keys.html</a></p>
</dd>
</dl>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Marcelo Alcocer

    </p>
  </div>
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>